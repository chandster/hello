<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="../../assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <title>Hawk 2 - Settings</title>
</head>
<body class="settings-body hidden">
    <button id="goBackBtn" class="btn btn-secondary" style="position: absolute;">Go Back</button>
    <div class="container d-flex settings-container flex-nowrap">
        <div class="settings-title">Settings</div>
        <div class="col-4 me-5 settings-sidebar" id="settings-sidebar">
            <div class="settings-entry selected" id="indexing" data-tooltip="Indexing settings" data-target="indexing-pane">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-clipboard-check settings-icon" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h-1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>
                <span class="settings-icon-text">Indexing</span>
            </div>
            <div class="settings-entry" id="backup" data-tooltip="Backup and restore" data-target="backup-pane">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-device-ssd settings-icon" viewBox="0 0 16 16">
                    <path d="M4.75 4a.75.75 0 0 0-.75.75v3.5c0 .414.336.75.75.75h6.5a.75.75 0 0 0 .75-.75v-3.5a.75.75 0 0 0-.75-.75zM5 8V5h6v3zm0-5.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0m7 0a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0M4.5 11a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1m7 0a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"/>
                    <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm11 12V2a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1v-2a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2a1 1 0 0 0 1-1m-7.25 1v-2H5v2zm1.75 0v-2h-.75v2zm1.75 0v-2H8.5v2zM11 13h-.75v2H11z"/>
                </svg>
                <span class="settings-icon-text">Backup</span>
            </div>
            <div class="settings-entry" id="appearance" data-tooltip="Appearance settings" data-target="appearance-pane">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-palette settings-icon" viewBox="0 0 16 16">
                    <path d="M8 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3m4 3a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3M5.5 7a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m.5 6a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"/>
                    <path d="M16 8c0 3.15-1.866 2.585-3.567 2.07C11.42 9.763 10.465 9.473 10 10c-.603.683-.475 1.819-.351 2.92C9.826 14.495 9.996 16 8 16a8 8 0 1 1 8-8m-8 7c.611 0 .654-.171.655-.176.078-.146.124-.464.07-1.119-.014-.168-.037-.37-.061-.591-.052-.464-.112-1.005-.118-1.462-.01-.707.083-1.61.704-2.314.369-.417.845-.578 1.272-.618.404-.038.812.026 1.16.104.343.077.702.186 1.025.284l.028.008c.346.105.658.199.953.266.653.148.904.083.991.024C14.717 9.38 15 9.161 15 8a7 7 0 1 0-7 7"/>
                </svg>
                <span class="settings-icon-text">Appearance</span>
            </div>
            <div class="settings-entry" id="about" data-tooltip="About Hawk 2" data-target="about-pane">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-info-circle settings-icon" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
                    <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
                </svg>
                <span class="settings-icon-text">About</span>
            </div>
            <div class="settings-indicator"></div>
        </div>
        <div class="col-8" style="padding-left: 0px; padding-right: 0px;">
            <div class="settings-pane active" id="indexing-pane">
                <div class="section-heading index-heading">Allowed sites</div>
                
                <!-- Tab Navigation -->
                <ul class="nav nav-tabs" id="indexerTabs" role="tablist" style="display: flex; justify-content: space-around;">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link active" id="sites-tab" data-bs-toggle="tab" href="#sites" role="tab">Sites</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="urls-tab" data-bs-toggle="tab" href="#urls" role="tab">URLs</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="string-matches-tab" data-bs-toggle="tab" href="#string-matches" role="tab">String matches</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="regex-tab" data-bs-toggle="tab" href="#regex" role="tab">RegEx</a>
                    </li>
                </ul>
              
                <!-- Search and Actions Row -->
                <div class="indexer-controls">
                    <div class="search-action-row">
                        <input type="text" class="search-bar-sm" id="rule-search" placeholder="Type to search allow list">
                        <div class="action-buttons">
                            <button class="btn btn-secondary add-rule-btn" data-bs-toggle="modal" data-bs-target="#addRuleModal">
                                Add allow rule
                            </button>
                            <button type="button" id="addCurrentSite" class="btn btn-secondary add-rule-btn">
                                Add URL
                            </button>
                        </div>
                    </div>
                </div>
                <div class="tab-content mt-2">
                    <div class="tab-pane fade show active" id="sites" role="tabpanel">
                        <ul class="index-list" id="sites-list"></ul>
                    </div>
                    <div class="tab-pane fade" id="urls" role="tabpanel">
                        <ul class="index-list" id="urls-list"></ul>
                    </div>
                    <div class="tab-pane fade" id="string-matches" role="tabpanel">
                        <ul class="index-list" id="string-matches-list"></ul>
                    </div>
                    <div class="tab-pane fade" id="regex" role="tabpanel">
                        <ul class="index-list" id="regex-list"></ul>
                    </div>
                </div>
            </div>
            <div class="settings-pane d-none" id="backup-pane">
                <div class="section-heading">Restore data</div>
                <div class="row flex settings-section align-contents-center">
                    <div class="">
                        <label for="jsonAllInput" class="btn btn-secondary restore-all-btn">Restore all from JSON file</label>
                        <input type="file" id="jsonAllInput" name="jsonAllInput" accept=".json" style="display: none;" />
                        
                        <label for="jsonSelectiveInput" class="btn btn-secondary import-selection-btn">Import data for selection</label>
                        <input type="file" id="jsonSelectiveInput" name="jsonSelectiveInput" accept=".json" style="display: none;" />
                    </div>    
                </div>
                <div class="col zero-margin zero-padding mt-3 d-none" id="backup-select-col">
                    <ul class="nav nav-tabs" id="backupTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <a class="nav-link active" id="notes-tab" data-bs-toggle="tab" href="#notes-selection-list" role="tab">Notes</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" id="tasks-tab" data-bs-toggle="tab" href="#tasks-selection-list" role="tab">Tasks</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" id="index-tab" data-bs-toggle="tab" href="#index-selection-list" role="tab">Index</a>
                        </li>
                        <div class="col d-flex align-items-center">
                            <input type="text" class="search-bar-sm w-50" id="selection-search" placeholder="Type to search selections">
                        </div>
                    </ul>
                    <div class="tab-content mt-2">
                        <div class="tab-pane fade show active" id="notes-selection-list" role="tabpanel"></div>
                        <div class="tab-pane fade" id="tasks-selection-list" role="tabpanel"></div>
                        <div class="tab-pane fade" id="index-selection-list" role="tabpanel"></div>
                    </div>
                    <button class="btn btn-secondary restore-selection-btn mt-4">Perform overwriting restore of selected data</button>
                </div>
                <div class="section-heading mt-4">Restore all data by category</div>
                <div class="row flex settings-section align-contents-center">
                    <div class="col-auto zero-margin zero-padding dynamic-title">Restore only the data from a given data category from the provided JSON backup</div>
                    <div>
                        <label for="jsonIndexInput" class="btn btn-secondary index-restore-btn">Upload data to restore search index</label>
                        <input type="file" id="jsonIndexInput" name="jsonIndexInput" accept=".json" style="display: none;" />
                        <label for="jsonInput" class="btn btn-secondary tasks-restore-btn">Upload data to restore tasks</label>
                        <input type="file" id="jsonInput" name="jsonInput" accept=".json" style="display: none;" />
                        <label for="jsonNoteInput" class="btn btn-secondary note-restore-btn">Upload data to restore notes</label>
                        <input type="file" id="jsonNoteInput" name="jsonNoteInput" accept=".json" style="display: none;" />
                    </div>
                </div>
                <div class="section-heading mt-4">Export data to backup</div>
                <div class="row flex settings-section align-contents-center">
                    <div class="col-auto zero-margin zero-padding dynamic-title">All data will be exported to a JSON file from which data can be restored in future</div>
                    <div class="col-auto zero-margin zero-padding mt-2 w-100">
                        <button class="btn btn-secondary backup-btn">Export extension data to JSON file</button>
                    </div>
                </div>
                <div class="section-heading mt-4">Reset</div>
                <div class="row flex settings-section align-contents-center mb-2">
                    <div class="col-auto zero-margin zero-padding dynamic-title">Remove all data and reset extension settings</div>
                    <div class="col-auto zero-margin zero-padding mt-2 w-100" data-bs-toggle="modal" data-bs-target="#eraseDataModal">
                        <button class="btn btn-danger reset-btn">Erase all data and settings</button>
                    </div>
                </div>
            </div>
            <div class="settings-pane d-none" id="appearance-pane">
                <div class="section-heading">Wallpaper</div>
                <div class="row flex settings-section align-contents-center mb-4">
                    <div class="col-auto zero-margin zero-padding dynamic-title">Change background on To-Do List and Notebook pages</div>
                    <div class="col-auto d-flex zero-margin zero-padding w-100 mt-2 settings-wallpaper-preview">
                        <img class="settings-wallpaper-preview-img">
                    </div>
                    <div class="col-auto zero-margin zero-padding w-100 mt-2">
                        <button class="btn btn-secondary background-reset-btn">Restore to default</button>
                        <label for="backgroundInput" class="btn btn-secondary browse-background-btn">Browse for background</label>
                        <input type="file" id="backgroundInput" name="jsonBackgroundInput" accept="image/*" style="display: none;" />
                    </div>
                </div>
            </div>
            <div class="settings-pane d-flex d-none dynamic-title" id="about-pane">
                <div class="row zero-padding zero-margin">
                    <div class="text-center mb-5">
                        <img class="logo-128 zero-padding">
                        <p>
                        <h3>Hawk 2 <br>1.0.1</h3>
                        </p>
                    </div>
                    <h3>Usage</h3>
                    <p>
                    Through the pop-up or sidepanel accessed by clicking the extension in your browser extension menu, you can access the different features by clicking the arrow buttons. <br \>
                    The extension indexes automatically. To search your indexed content, type "@i" in the browser omnibar, then press Tab and enter your search query. 
                    </p>
                    <h3>Adding Notes</h3>
                    <p>
                    To add a note, you can add it by selecting the box at the top of the homepage. You can change the description and due date, as well as create tags to add to your task in this box.<br />
                    You can edit notes by clicking on them in the table, press save to ensure any changes made are kept. You can also delete notes from this page.<br\>
                    The filter button to the right of the search bar allows you to filter by category. <br\>
                    When a task is due, the text on the task will turn red, the due date will say "OVERDUE", and you will receive an OS notification. <br/>
                    To add notes from a webpage faster, if you select the text you wish to add and right click to see Googles context menu, you can press "Hawk - Add to notes" and this will dynamically added to the site.
                    </p>

                    <h3>Appearance</h3>
                    <p>
                    If you wish to change the background of the notes and tasks pages, you can do this by navigating to Settings > Appearance, and under Wallpaper, clicking "Browse for background". Select your image; choose something high quality!<br />
                    </p>   
                    <h3>Changing indexing behaviour</h3>
                    <p>
                    By default, the application indexes pages with the domains "amazon.com", "atoz.amazon.work", "quip-amazon.com", and "quip.com". You may wish for more or other domains to be indexed when visited, or create allow rules. To edit this, navigate to Settings > Indexing, then choose a tab corresponding to different lists of allow rules. To add an allow rule, click 'Add allow rule' and type the rule text out. To delete rules, press the delete button on the right of each rule in a given list. <br />
                    </p>
                    <h3>Backup and restoration</h3>
                    <p>
                    To back up your data, navigate to Settings > Backup and Restore, and select "Export extension data to JSON file". <br />
                    To restore data to a new install of the extension, navigate to Settings > Backup and Restore, and select "Restore all from JSON file". If you want to be more specific about which data to restore, you can upload data to restore your search index, tasks, or notes under the "Restore all data by category" section. <br />
                    You can also remove all data and reset the extension settings by selecting the red "Erase all data and settings" button at the bottom of the page.
                    </p>                 
                    <h3>Developer contact:</h3>
                    <p>
                  
                   
                    Kieran Watters<br>
                    2659434w@student.gla.ac.uk<br><br>
                    Yigit Sayar<br>
                    2795191s@student.gla.ac.uk<br><br>
                    Jaden Green<br>
                    2620600g@student.gla.ac.uk<br><br>
                    Devansh Sharma<br>
                    2723338s@student.gla.ac.uk<br><br>
                    Ryan Magaya<br>
                    2786978m@student.gla.ac.uk<br><br>
                    Kalila Chand<br>
                    2771804c@student.gla.ac.uk<br><br>
                    
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addRuleModal" rule-loc="allowedSites">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="addRuleModalLabel">Add an allow rule</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addRuleForm">
                        <div class="form-group">
                            <label for="addRuleInput" class="dynamic-title">Specify rule</label>
                            <input type="text" class="form-control" id="addRuleInput" placeholder="Enter allow rule here" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" form="addRuleForm" data-bs-dismiss="modal" id="addRule" class="btn btn-secondary">Add Rule</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="deleteRuleModal" rule-loc="allowedSites" rule-to-delete="">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="deleteRuleModalLabel">Confirm deletion</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    Are you sure you want to delete this rule?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger rule-delete-btn" data-bs-dismiss="modal" id="confirmDelete">Delete</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="ruleErrorModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="ruleErrorModalLabel">Error</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    This allow rule already exists.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="dismissError">OK</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="eraseDataModal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title text-danger">Erase all data and settings</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p><strong>You are about to erase all data and settings of the extension.</strong><br><br> All data and settings will be erased. <br>This action cannot be undone.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-danger" data-bs-dismiss="modal" id="confirm-erase-data-btn">Erase all data and settings</button>
          </div>
        </div>
      </div>
    </div>
    <script type="module" src="../../assets/js/jquery-3.7.1.min.js"></script>
    <script type="module" src="../../assets/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="../features/settings_navigation.js"></script>
    <script type="module" src="../utils/appearance.js"></script>
    <script type="module" src="../features/todo_make_settings.js"></script>
</body>
</html>
